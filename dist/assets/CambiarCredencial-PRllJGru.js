import{V as $,a as w,_ as z,c as q,b as P,f as S,k as D,l as E,m as j}from"./VTextField-KuveOSAe.js";import{p as N,m as U,a as G,b as M,g as Y,c as Z,a4 as H,a6 as J,d as e,y as K,ac as O,r as u,u as Q,z as L,B,C as W,G as X,e as k,f as R,w as a,k as s,ad as A,l as g,i as ee,j as ae,F as se,v as h,V as te,h as oe,t as ne}from"./index-8TxKCO8e.js";import{V as I,b as le,c as re,d as ie}from"./VCard-paBMn9Wn.js";import{V as de}from"./VContainer-qKTR7Mb1.js";import{n as ce,e as ue,o as me,q as fe,r as ve,s as pe,h as ge,t as he,i as Ce,v as Ve,w as ye,x as xe,y as ke,V as be,z as _e}from"./VBtn-TV862Wp4.js";import{V as we}from"./index-hzE6LT8Q.js";const Pe=N({color:String,...ce(),...U(),...ue(),...me(),...fe(),...ve(),...pe(),...G(),...M()},"VSheet"),Se=Y()({name:"VSheet",props:Pe(),setup(o,C){let{slots:b}=C;const{themeClasses:v}=Z(o),{backgroundColorClasses:n,backgroundColorStyles:l}=ge(H(o,"color")),{borderClasses:V}=he(o),{dimensionStyles:p}=Ce(o),{elevationClasses:d}=Ve(o),{locationStyles:y}=ye(o),{positionClasses:m}=xe(o),{roundedClasses:c}=ke(o);return J(()=>e(o.tag,{class:["v-sheet",v.value,n.value,V.value,d.value,m.value,c.value,o.class],style:[l.value,p.value,y.value,o.style]},b)),{}}}),Le=h("p",{class:"text-secondary text-h6 mt-5"},"Cambio de contraseña",-1),Be={class:"d-flex justify-center mb-5 mt-9"},Re={class:"mt-4 mb-5 text-center",color:"red"},qe={__name:"CambiarCredencial",setup(o){const C=K(),v=O().query.token;let n=u(!1),l=u(!1);const V=u(),p=Q();let d=L({clave:"",confirmaClave:""}),y=u(!1),m=u(!0);const c=u({clave:"",confirmaClave:""});let x=!1;const _=L([{regex:/^.{8,}$/,message:"Al menos 8 caracteres.",estado:!1},{regex:/[A-Z]/,message:"Al menos una letra mayúscula.",estado:!1},{regex:/[a-z]/,message:"Al menos una letra minúscula.",estado:!1},{regex:/[0-9]/,message:"Al menos un número."},{regex:/[@#$%^&*.]/,message:'Al menos un símbolo especial sin espacios "!@#$%^&*".',estado:!1}]);B(()=>p.user),W(d,r=>{let t=0;m=!0,_.forEach(f=>{f.regex.test(r.clave.trim())?(t++,f.estado=!0):f.estado=!1}),t==5&&(m=!1)}),B(()=>p.isLoggedIn);async function T(){if(y){x=!0;try{v&&oe.post(`actualizar-clave/?token=${v}`,d).then(r=>{r.status==200&&C.push({name:"login"})}).catch(r=>{r.response.data.error=="The password is too similar to the last name."?c.value.clave="La clave es demasiado similar a tu apellio":r.response.data.detail.code=="no_coincide"&&(c.value.confirmaClave=r.response.data.detail.message)})}catch{c.value.clave="Datos incorrectos o inválidos",c.value.confirmaClave="Revisa tu contraseña o sigue el procedimiento para reiniciarla"}}x=!1}return(r,t)=>{const f=X("router-link");return k(),R(I,null,{default:a(()=>[e(we,null,{default:a(()=>[e($,{color:"background",permanent:"",location:"right",width:"704",elevation:1,id:"navigation-drawer-br-radius"},{default:a(()=>[e(le,{"min-width":"340","min-height":"510"},{default:a(()=>[e(w,{density:"compact",nav:"",class:"d-flex align-center justify-center",style:{height:"100vh"}},{default:a(()=>[e(I,{width:"461",height:"762",class:"rounded-xl mt-8 pt-8",elevation:1},{default:a(()=>[e(re,{class:"d-flex align-center flex-column justify-center mt-5"},{default:a(()=>[e(ie,{image:z,rounded:"0",size:"80"}),Le]),_:1}),e(de,null,{default:a(()=>[e(q,{ref_key:"loginForm",ref:V},{default:a(()=>[e(P,{class:"custom-hint-color mb-5",modelValue:s(d).clave,"onUpdate:modelValue":t[0]||(t[0]=i=>s(d).clave=i),placeholder:"Contraseña","persistent-hint":"",flat:"","append-inner-icon":s(n)?"mdi-eye":"mdi-eye-off",type:s(n)?"text":"password",variant:"outlined",hint:"Ingresa la contraseña nueva",rules:[s(S).required],"error-messages":c.value.clave,"onClick:appendInner":t[1]||(t[1]=i=>A(n)?n.value=!s(n):n=!s(n))},null,8,["modelValue","append-inner-icon","type","rules","error-messages"]),e(P,{class:"custom-hint-color mb-5",modelValue:s(d).confirmaClave,"onUpdate:modelValue":t[2]||(t[2]=i=>s(d).confirmaClave=i),placeholder:"Contraseña","persistent-hint":"",flat:"","append-inner-icon":s(l)?"mdi-eye":"mdi-eye-off",type:s(l)?"text":"password",variant:"outlined",hint:"Ingresa nuevamente tu contraseña nueva",rules:[s(S).required],"error-messages":c.value.confirmaClave,"onClick:appendInner":t[3]||(t[3]=i=>A(l)?l.value=!s(l):l=!s(l))},null,8,["modelValue","append-inner-icon","type","rules","error-messages"]),e(Se,{dense:""},{default:a(()=>[e(D,{class:"mb-n8"},{default:a(()=>[g("La contraseña debe tener: ")]),_:1}),e(w,{dense:""},{default:a(()=>[(k(!0),ee(se,null,ae(_,(i,F)=>(k(),R(E,{class:"mb-n6",key:F},{prepend:a(()=>[e(_e,{class:"font-weight-bold",color:i.estado?"success":"primary-"},{default:a(()=>[g(" mdi-check")]),_:2},1032,["color"])]),default:a(()=>[e(j,{class:"text-caption",textContent:ne(i.message)},null,8,["textContent"])]),_:2},1024))),128))]),_:1})]),_:1}),h("div",Be,[e(be,{onClick:t[4]||(t[4]=i=>T()),class:"text-none",rounded:"xl",color:"secondary",size:"x-large",width:"25vh",loading:s(x),disabled:s(m)},{default:a(()=>[g(" Cambiar ")]),_:1},8,["loading","disabled"])]),h("div",Re,[h("strong",null,[e(f,{to:{name:"login"},class:"text-secondary text-decoration-none font-weigth-bold"},{default:a(()=>[g("Ya tengo cuenta")]),_:1})])])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(te,{class:"bg-login"})]),_:1})]),_:1})}}};export{qe as default};
