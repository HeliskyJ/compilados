import{p as $,m as z,a as E,b as N,g as U,c as H,H as J,J as M,d as e,_ as X,ao as Z,aq as G,r as u,e as K,ap as x,C as P,X as O,am as Q,f as p,h as S,w as a,l as s,j as b,ab as B,s as w,k as W,F as Y,n as ee,y as A,V as ae,i as se,t as te}from"./index-kKdGCNTv.js";import{j as oe,e as T,_ as ne,d as I,l as re,g as le,i as ie}from"./VNavigationDrawer-mhgLr_4z.js";import{V as ce,f as R}from"./VForm-gsmbMxCf.js";import{B as de}from"./BotonBi-aYjw3oQ-.js";import{V as q,c as ue,d as me,b as fe,a as pe}from"./VCard-BF-vllR0.js";import{V as ve}from"./VContainer-mYOJDngs.js";import{i as ge,x as he,j as Ce,z as _e,C as ye,k as Ve,g as ke,o as xe,y as be,q as we,A as Le,D as Pe,r as Se,d as Be}from"./VGrid-hx-kg6fk.js";import{V as Ae}from"./VLayout-ueVDUMp-.js";import"./index-Y5RnL3hI.js";const Te=$({color:String,...ge(),...z(),...he(),...Ce(),..._e(),...ye(),...Ve(),...E(),...N()},"VSheet"),Ie=U()({name:"VSheet",props:Te(),setup(t,v){let{slots:g}=v;const{themeClasses:h}=H(t),{backgroundColorClasses:_,backgroundColorStyles:r}=ke(J(t,"color")),{borderClasses:l}=xe(t),{dimensionStyles:y}=be(t),{elevationClasses:C}=we(t),{locationStyles:i}=Le(t),{positionClasses:V}=Pe(t),{roundedClasses:m}=Se(t);return M(()=>e(t.tag,{class:["v-sheet",h.value,_.value,l.value,C.value,V.value,m.value,t.class],style:[r.value,y.value,i.value,t.style]},g)),{}}}),Re={key:0,class:"text-secondary text-h6 mt-5"},qe={key:1,class:"text-secondary text-h6 mt-5"},Fe={class:"mt-4 mb-5 text-center",color:"red"},je={__name:"CambiarCredencial",setup(t){const v=Z(),g=G(),h=g.query.token,_=g.query.motivo;let r=u(!1),l=u(!1);const y=u(),C=K();let i=x({clave:"",confirmaClave:""}),V=u(!1),m=u(!0);const c=u({clave:"",confirmaClave:""});let k=u(!1);const L=x([{regex:/^.{8,}$/,message:"Al menos 8 caracteres.",estado:!1},{regex:/[A-Z]/,message:"Al menos una letra mayúscula.",estado:!1},{regex:/[a-z]/,message:"Al menos una letra minúscula.",estado:!1},{regex:/[0-9]/,message:"Al menos un número."},{regex:/[@#$%^&*.]/,message:'Al menos un símbolo especial sin espacios "!@#$%^&*".',estado:!1}]);P(()=>C.user);let F=x({cargando:k,deshabilitado:m,valorBtn:"Cambiar"});O(i,o=>{let n=0;m.value=!0,L.forEach(f=>{f.regex.test(o.clave.trim())?(n++,f.estado=!0):f.estado=!1}),n==5&&(m.value=!1)}),P(()=>C.isLoggedIn);async function j(){V&&(k.value=!0,h&&se.post(`actualizar-clave/?token=${h}`,i).then(o=>{o.status==200&&v.push({name:"login"})}).catch(o=>{o.response.data.error=="The password is too similar to the last name."?c.value.clave="La clave es demasiado similar a tu apellio":o.response.data.detail=="The password is too similar to the first name."?c.value.clave="La clave es demasiado similar a tu nombre":o.response.data.detail=="The password is too similar to the email address."?c.value.clave="La clave es demasiado similar a tu dirección de correo":o.response.data.detail.code=="no_coincide"?c.value.confirmaClave=o.response.data.detail.message:o.response.data.detail=="Token invalido o error"&&v.push({name:"token_expirado"}),c.value.clave="Datos incorrectos o inválidos",c.value.confirmaClave="Revisa tu contraseña o sigue el procedimiento para reiniciarla"})),k.value=!1}return(o,n)=>{const f=Q("router-link");return p(),S(q,null,{default:a(()=>[e(Ae,null,{default:a(()=>[e(oe,{color:"background",permanent:"",location:"right",width:"704",elevation:1,id:"navigation-drawer-br-radius"},{default:a(()=>[e(ue,{"min-width":"340","min-height":"510"},{default:a(()=>[e(T,{density:"compact",nav:"",class:"d-flex align-center justify-center",style:{height:"100vh"}},{default:a(()=>[e(q,{width:"461",height:"762",class:"rounded-xl mt-8 pt-8",elevation:1},{default:a(()=>[e(me,{class:"d-flex align-center flex-column justify-center mt-5"},{default:a(()=>[e(fe,{size:"80",rounded:"0"},{default:a(()=>[e(pe,{src:ne})]),_:1}),s(_)=="NC"?(p(),b("p",Re,"Creación de Contraseña")):(p(),b("p",qe,"Actualización de contraseña"))]),_:1}),e(ve,null,{default:a(()=>[e(ce,{ref_key:"loginForm",ref:y},{default:a(()=>[e(I,{class:"custom-hint-color mb-5",modelValue:s(i).clave,"onUpdate:modelValue":n[0]||(n[0]=d=>s(i).clave=d),placeholder:"Contraseña","persistent-hint":"",flat:"","append-inner-icon":s(r)?"mdi-eye":"mdi-eye-off",type:s(r)?"text":"password",variant:"outlined",hint:"Ingresa la contraseña nueva",rules:[s(R).required],"error-messages":c.value.clave,"onClick:appendInner":n[1]||(n[1]=d=>B(r)?r.value=!s(r):r=!s(r))},null,8,["modelValue","append-inner-icon","type","rules","error-messages"]),e(I,{class:"custom-hint-color mb-5",modelValue:s(i).confirmaClave,"onUpdate:modelValue":n[2]||(n[2]=d=>s(i).confirmaClave=d),placeholder:"Contraseña","persistent-hint":"",flat:"","append-inner-icon":s(l)?"mdi-eye":"mdi-eye-off",type:s(l)?"text":"password",variant:"outlined",hint:"Ingresa nuevamente tu contraseña nueva",rules:[s(R).required],"error-messages":c.value.confirmaClave,"onClick:appendInner":n[3]||(n[3]=d=>B(l)?l.value=!s(l):l=!s(l))},null,8,["modelValue","append-inner-icon","type","rules","error-messages"]),e(Ie,{dense:""},{default:a(()=>[e(re,{class:"mb-n8"},{default:a(()=>[w("La contraseña debe tener: ")]),_:1}),e(T,{dense:""},{default:a(()=>[(p(!0),b(Y,null,W(L,(d,D)=>(p(),S(le,{class:"mb-n6",key:D},{prepend:a(()=>[e(Be,{class:"font-weight-bold",color:d.estado?"success":"primary-"},{default:a(()=>[w(" mdi-check")]),_:2},1032,["color"])]),default:a(()=>[e(ie,{class:"text-caption",textContent:te(d.message)},null,8,["textContent"])]),_:2},1024))),128))]),_:1})]),_:1}),e(de,ee(s(F),{onAccion:j}),null,16),A("div",Fe,[A("strong",null,[e(f,{to:{name:"login"},class:"text-secondary text-decoration-none font-weigth-bold"},{default:a(()=>[w("Iniciar Sesión")]),_:1})])])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(ae,{class:"bg-login"})]),_:1})]),_:1})}}},Xe=X(je,[["__file","/home/projects/abastecimiento-app/frontend/src/pages/autenticacion/CambiarCredencial.vue"]]);export{Xe as default};
