import{V as D,a as L,_ as E,b as q,c as P,f as S,e as N,g as j,h as z}from"./VTextField-nJ4DsiDY.js";import{p as M,m as U,a as H,b as K,g as O,c as Z,M as G,K as J,d as e,A as Q,N as W,r as u,e as X,B as _,D as B,E as Y,H as ee,f as k,h as T,w as a,l as s,O as A,s as y,j as ae,k as se,F as te,n as oe,y as b,V as ne,i as re,t as le}from"./index-S5gMVsrA.js";import{_ as ie}from"./BotonBi-4AGVOAuD.js";import{V as I,b as de,c as ce,d as ue,a as me}from"./VCard-Pq-6J6-t.js";import{V as fe}from"./VContainer-1scMj2Ou.js";import{d as ve,e as pe,f as ge,g as he,h as Ce,i as Ve,j as _e,k as ke,l as ye,n as be,o as xe,p as we,q as Le,r as Pe}from"./VBtn-Mz8BOYE_.js";import{V as Se}from"./index-rrGOyYlW.js";const Be=M({color:String,...ve(),...U(),...pe(),...ge(),...he(),...Ce(),...Ve(),...H(),...K()},"VSheet"),Te=O()({name:"VSheet",props:Be(),setup(t,v){let{slots:x}=v;const{themeClasses:p}=Z(t),{backgroundColorClasses:l,backgroundColorStyles:i}=_e(G(t,"color")),{borderClasses:h}=ke(t),{dimensionStyles:g}=ye(t),{elevationClasses:d}=be(t),{locationStyles:C}=xe(t),{positionClasses:m}=we(t),{roundedClasses:r}=Le(t);return J(()=>e(t.tag,{class:["v-sheet",p.value,l.value,h.value,d.value,m.value,r.value,t.class],style:[i.value,g.value,C.value,t.style]},x)),{}}}),Ae=b("p",{class:"text-secondary text-h6 mt-5"},"Cambio de contraseña",-1),Ie={class:"mt-4 mb-5 text-center",color:"red"},je={__name:"CambiarCredencial",setup(t){const v=Q(),p=W().query.token;let l=u(!1),i=u(!1);const h=u(),g=X();let d=_({clave:"",confirmaClave:""}),C=u(!1),m=u(!0);const r=u({clave:"",confirmaClave:""});let V=u(!1);const w=_([{regex:/^.{8,}$/,message:"Al menos 8 caracteres.",estado:!1},{regex:/[A-Z]/,message:"Al menos una letra mayúscula.",estado:!1},{regex:/[a-z]/,message:"Al menos una letra minúscula.",estado:!1},{regex:/[0-9]/,message:"Al menos un número."},{regex:/[@#$%^&*.]/,message:'Al menos un símbolo especial sin espacios "!@#$%^&*".',estado:!1}]);B(()=>g.user);let R=_({cargando:V,deshabilitado:m,valorBtn:"Cambiar"});Y(d,o=>{let n=0;m.value=!0,w.forEach(f=>{f.regex.test(o.clave.trim())?(n++,f.estado=!0):f.estado=!1}),n==5&&(m.value=!1)}),B(()=>g.isLoggedIn);async function F(){if(C){V.value=!0;try{p&&re.post(`actualizar-clave/?token=${p}`,d).then(o=>{o.status==200&&v.push({name:"login"})}).catch(o=>{o.response.data.error=="The password is too similar to the last name."?r.value.clave="La clave es demasiado similar a tu apellio":o.response.data.detail=="The password is too similar to the first name."?r.value.clave="La clave es demasiado similar a tu nombre":o.response.data.detail=="The password is too similar to the email address."?r.value.clave="La clave es demasiado similar a tu dirección de correo":o.response.data.detail.code=="no_coincide"?r.value.confirmaClave=o.response.data.detail.message:o.response.data.detail=="Token invalido o error"&&v.push({name:"token_expirado"})})}catch{r.value.clave="Datos incorrectos o inválidos",r.value.confirmaClave="Revisa tu contraseña o sigue el procedimiento para reiniciarla"}}V.value=!1}return(o,n)=>{const f=ee("router-link");return k(),T(I,null,{default:a(()=>[e(Se,null,{default:a(()=>[e(D,{color:"background",permanent:"",location:"right",width:"704",elevation:1,id:"navigation-drawer-br-radius"},{default:a(()=>[e(de,{"min-width":"340","min-height":"510"},{default:a(()=>[e(L,{density:"compact",nav:"",class:"d-flex align-center justify-center",style:{height:"100vh"}},{default:a(()=>[e(I,{width:"461",height:"762",class:"rounded-xl mt-8 pt-8",elevation:1},{default:a(()=>[e(ce,{class:"d-flex align-center flex-column justify-center mt-5"},{default:a(()=>[e(ue,{size:"80",rounded:"0"},{default:a(()=>[e(me,{src:E})]),_:1}),Ae]),_:1}),e(fe,null,{default:a(()=>[e(q,{ref_key:"loginForm",ref:h},{default:a(()=>[e(P,{class:"custom-hint-color mb-5",modelValue:s(d).clave,"onUpdate:modelValue":n[0]||(n[0]=c=>s(d).clave=c),placeholder:"Contraseña","persistent-hint":"",flat:"","append-inner-icon":s(l)?"mdi-eye":"mdi-eye-off",type:s(l)?"text":"password",variant:"outlined",hint:"Ingresa la contraseña nueva",rules:[s(S).required],"error-messages":r.value.clave,"onClick:appendInner":n[1]||(n[1]=c=>A(l)?l.value=!s(l):l=!s(l))},null,8,["modelValue","append-inner-icon","type","rules","error-messages"]),e(P,{class:"custom-hint-color mb-5",modelValue:s(d).confirmaClave,"onUpdate:modelValue":n[2]||(n[2]=c=>s(d).confirmaClave=c),placeholder:"Contraseña","persistent-hint":"",flat:"","append-inner-icon":s(i)?"mdi-eye":"mdi-eye-off",type:s(i)?"text":"password",variant:"outlined",hint:"Ingresa nuevamente tu contraseña nueva",rules:[s(S).required],"error-messages":r.value.confirmaClave,"onClick:appendInner":n[3]||(n[3]=c=>A(i)?i.value=!s(i):i=!s(i))},null,8,["modelValue","append-inner-icon","type","rules","error-messages"]),e(Te,{dense:""},{default:a(()=>[e(N,{class:"mb-n8"},{default:a(()=>[y("La contraseña debe tener: ")]),_:1}),e(L,{dense:""},{default:a(()=>[(k(!0),ae(te,null,se(w,(c,$)=>(k(),T(j,{class:"mb-n6",key:$},{prepend:a(()=>[e(Pe,{class:"font-weight-bold",color:c.estado?"success":"primary-"},{default:a(()=>[y(" mdi-check")]),_:2},1032,["color"])]),default:a(()=>[e(z,{class:"text-caption",textContent:le(c.message)},null,8,["textContent"])]),_:2},1024))),128))]),_:1})]),_:1}),e(ie,oe(s(R),{onAccion:F}),null,16),b("div",Ie,[b("strong",null,[e(f,{to:{name:"login"},class:"text-secondary text-decoration-none font-weigth-bold"},{default:a(()=>[y("Iniciar Sesión")]),_:1})])])]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(ne,{class:"bg-login"})]),_:1})]),_:1})}}};export{je as default};
